\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
% \PassOptionsToPackage{numbers, compress}{natbib}
% before loading nips_2016
%
% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{nips_2016}

\usepackage[final]{nips_2016}

% to compile a camera-ready version, add the [final] option, e.g.:
% \usepackage[final]{nips_2016}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor, graphicx, float}


\newcommand{\selfnote}[1]{\footnote{\textcolor{red}{#1}}}
\newcommand{\Liangdoubt}[1]{\footnote{\textcolor{olive}{#1}}}

\title{Commuter classification and behavior clustering: Beijing use case}

% The \author macro works with any number of authors. There are two
% commands used to separate the names and addresses of multiple
% authors: \And and \AND.
%
% Using \And between authors leaves it to LaTeX to determine where to
% break the lines. Using \AND forces a line break at that point. So,
% if LaTeX puts 3 of 4 authors names on the first line, and the last
% on the second line, try using \AND instead of \And before the third
% author name.

\author{
  Selene Baez  Santamaria \\
  \texttt{s.baezsantamaria@student.vu.nl}
}

\begin{document}
% \nipsfinalcopy is no longer used

\maketitle

\begin{abstract}
  Public transportation, centered on subway and bus networks, is an data-rich domain that can benefit from data mining and machine learning techniques. The classification of commuters versus non-commuter/occasional travelers can help government, transport management and operators to better target their policies in order to improve the transportation network in large cities. Furthermore, characterizing commuters by behavior clustering can bring deeper insight into their needs and routines as a whole. 
  This project proposes the usage of ensemble models for classification and clustering of public transport users. For this purpose, transit card data will be used, available from the city of Beijing, China. 
\end{abstract}

\newpage

\tableofcontents

\newpage
\section{Introduction}

\subsection{Transportation domain}
Public transportation facilities are commonly composed by subway lines, buses, trams, train and others. As a network, they provide service for the majority of citizens in urban areas. \selfnote{reference}  

The usage of the public transport network as a whole has a significant environmental impact on the city, affecting noise and air pollution. \selfnote{references}. 

Furthermore, abusing motorized vehicles relates to energetic demand. Petroleum and other carbon based products are always in high demand, and electrical supplies are not yet widely spread. This may bring further economical implications.\selfnote{reference}

\Liangdoubt{papers to justify this}

In the last years, smart cards systems appeared, making it possible to track travelers and facilitating the fare collection. Examples are Octopus card in Hong Kong, Oyster card in London, OV-chipcard in The Netherlands and IC card in Beijing, to name a few.


\subsubsection{Who are the commuters?}
A major proportion of public transport users is represented by commuters. These are regular users of public transit, with regularity in the boarding times/stops. 

Driven by a routine, commuters travel back and forth from specific places, commonly represented by home to work/school trips. As commuters use public transit almost daily, or with a regular temporal pattern, the  conditions of the public network directly influence commuter's personal life and generally impacts their quality of life \selfnote{reference}. If the commuting experience is bad, daily travel can bring sorrow to users. Bad experiences may include excessively long commuting time, crowded spaces, inconvenient transfers, elevated prices, low-quality of facilities, and others. 

Identifying commuters can help in the long-term planning of public transportation. Policies for improving the overall experience and aid urban areas on a large scale.

Transportation follows swarm behavior. Based on individual travels and routines, on a larger scale travelers exhibit peculiar characteristics. Both levels of understanding are crucial.   

\subsection{The city of Beijing}
Beijing special case for urbanization. Number of people is massive \selfnote{reference}

Pollution in Beijing \selfnote{reference}

Beijing has more than 1000 bus routes and 18 subway lines, and it continues to expand every year. This results in more than 28,000 stops combined. \selfnote{reference Beijing transportation center}. 

Additionally, Beijing has implemented several Bike sharing systems, with specific dropping stations. \Liangdoubt{where to get this info}.

Number of users per day.

By the usage of smart transit cards, collection of payment and transaction monitoring is possible. Buses, subways, bikes and taxis are monitored. Real time and historical data is available. Over 90\% of public transit users are smart card holders. \selfnote{reference}

\subsection{Motivation}
Interdisciplinary study between Artificial Intelligence and Metropolitan Transportation. Introduce data mining techniques to a data rich domain. 

Relevance of project on both areas. 

\subsubsection{Societal context}
Commuters use the public transport network regularly to go to work, school or other follow other routines. They need reliable means of transportation. \selfnote{reference: what do commuters care about}.

The city of Beijing faces a large imbalance between residential and working areas. \selfnote{reference}. Targeting this group brings the largest benefits to the public.  

Government, transport management and operators can gain spatial and temporal insight. This insight can lead to tangible results, policies and counter measures increasing efficiency of network, adjustable travel fares used as incentives to relieve peak hours, urban planning for residential and industrial land use, and others \selfnote{reference}

\subsubsection{Scientific context}
Usage of machine learning of data mining has been limited. Current broadly used method is surveys to reach travelers on individual level and aggregated measurements for gathering  their collective behavior. The analysis is usually done with statistical methodology. 

Surveys are costly and based on self-report, which by itself has bias problems. Other problems are small population and non-representative samples. 

Aggregated methods miss the interactions between individuals that cause the collective behavior. 

Technology has reached the data collection point, but has yet to reach the analysis part. Transit cards are capable of recording spatio-temporal information at an individual level over long periods of time. This generates large amounts of data. 

Many prediction algorithms available. Constant refinement, state of the art must be applied to real life and large impact situations. Domain experts must focus on analyzing insights and using them, not on techniques for curating and making sense out of raw data. 

\subsection{Thesis organization}
This Thesis is organized as follows:

First we do a literature review for previous work on mining transit data and for specific state-of-the art methodologies. Consequently, we establish the scope and objectives of this project. We continue to describe the methodology thoroughly, including the data and the approach. Following this description, we identify three distinct stages of the project and report their corresponding experimentation. Then, we discuss the findings and gather conclusions. Finally, future work opportunities are explored. 


\newpage
\section{Literature review}

\subsection{Data mining on transit card data}
Preprocess data by Wang in BJUT lab. \cite{wang2014research}

Data mining to identify transit use cycles in Canadian smart card data \cite{morency2007measuring}

Density Based Scanning Algorithm with Noise to classify travelers according to their travel patterns.  \cite{ma2013mining}

Passenger segmentation by K-means clustering \cite{bhaskar2015passenger}

Machine learning for commuters identification. SVM with 94\% accuracy. \cite{tu2016impact}

11 distinct clusters of users with similar activity and demographic attributes \cite{langlois2016inferring}

The latest work on the field corresponds to Ma et Al \cite{ma2017understanding}. The objective of their work is to determine a scoring function for travelers that can correctly identify them as commuters, or non-commuters. In their work, they cluster stops using an improved DBSCAN algorithm. They engineer features for representing the frequency in which travelers follow spatio-temporal patterns. Travelers are then clustered according to these features following the ISODATA algorithm. As an output of the clustering, optimal cutoff levels in the scoring function were determined. As a result, evaluating a traveler does not depend on clustering centroids, but only on calculating the commuting score. This, as expressed by the authors, reduces computing time and treats each traveler independently from the others, which is not true for clustering algorithms.

A common practice, as used by \cite{ma2017understanding} and \cite{langlois2016inferring} is to divide the day into -hourly or half-and-hour- time bins.

\subsection{Classifying and clustering spatio-temporal data}
Ensemble methods

Classifiers in the transportation domain


\newpage
\section{Research objective}
Objective is to identify and characterize commuters in the city of Beijing by using IC card data. Find patterns in the spatio-temporal data of public transport travelers. 

\subsection{Research questions}
\begin{enumerate}
\item How accurately can commuters and non-commuters be identified using an ensemble model? How does this compare to the previous SVM model?
\item What is the minimal set of information needed from IC card data to reach an acceptable accuracy in classification?
\item To what extent is clustering commuters by its behavior informative to transportation specialists? 
\end{enumerate}

\subsubsection{Definition of terms}
A commuter is a public transit user whose IC card data reveals repeatable patterns in time and space over a working week (5 days, Monday through Friday).

A trip is a sequence of IC card transactions, including transfers, with an origin and destination. A trip is also represented as a record in the data, as it will be further explained in Section \ref{sec:data}

A transfer is a change in transportation mode. Transportation modes include Bus, Subway, and Bike. Transfers can then be: bus-bus, bus-subway, bus-bike, subway-bus, subway-bike, bike-bus, bike-subway or bike-bike. Changes between subway lines are not recorded. \Liangdoubt{transfer possible?} 

We make the assumption that IC card IDs and users have a one to one relationship, meaning each user has exactly one card and each card is used by exactly one user. \Liangdoubt{reasonable assumption?}

\subsection{Scope and structure}
\selfnote{revise this part}
The coverage of this Thesis is divided in three main stages: 

\begin{itemize}
\item[Part one]: classify commuters versus non-commuters. Ensemble model compared to SVM

\item[Part two]: the set of features will be revised to disregard redundant information. A second comparison with Tu\cite{tu2016impact}'s SVM model will be made. 

\item[Part three]: commuters will be further clustered according to patterns in their behaviors that will emerge from all variables of the IC card data. The clusters will be analyzed and interpreted to find distinctive characteristics that may be judged as useful by transportation specialists. 
\end{itemize}

\selfnote{better itemize bullets}


\newpage
\section{Methodology}
\subsection{The data}
\label{sec:data}
\selfnote{describe areas and their range. Include a map}
Every record for an IC card represents a trip. As such, it contains the following data fields:

\begin{itemize}
\item Data date: Year, month and day that the trip was made
\item Card code: card identification number
\item Path link: Mode of transportation. B for bus, R for subway, Y for bicycle. Transfers between modes are shown by a dash. \footnote{Example: B-B is Bus to Bus.} \Liangdoubt{calculated column?}
\item Travel time: Time spent in vehicles, measured in milliseconds
\item Travel distance: Distance traveled, measured in meters \selfnote{as measured by route?}
\item Transfer number: number of changes in travel mode during the trip
\item Transfer time average: time spent in transfer, divided by number of transfers \selfnote{calculated column?}
\item Transfer time sum: total time spent in transfer
\item Start time: time stamp of when the trip started
\item End time: time stamp of when the trip ended
\item On traffic: 
\item Off traffic:
\item On middle area:
\item Off middle area:
\item On big area:
\item Off big area:
\item On ring road:
\item Off ring road:
\item On/Off area: Integer from 1 to 18 corresponding to the district/county for boarding and alighting, correspondingly. See Figure \ref{fig:beijing/18areas} \selfnote{reference} \selfnote{include in preprocessing dictionary?} 
%http://www.ebeijing.gov.cn/Government/Administration_region/}
\item ID: number| time stamp of beginning of trip | card code
\item Transfer detail: Station name, line number, mode of transportation
\end{itemize}

\begin{figure}[H]
  \centering
  \includegraphics[width=.8\linewidth]{./images/beijing_18areas.png}
  \caption{Beijing's Districts and its Counties}
  \label{fig:beijing/18areas}
\end{figure}

Every day, more than X records are collected. 50, 000 records are sampled every day for a month. 
\selfnote{how much data can we handle}

The month is April, which does not overlap with summer holidays. 

\subsubsection{Training data}
Since we perform supervised learning, we need training data for which we know if a record corresponds to a commuter or non-commuter. Such data is expensive and limited since it has only been obtained by asking the users directly if they are commuters or not. Other annotated data is not available, and labeling new records falls beyond the scope of this project. \selfnote{if data is not sufficient (although previous work shows it is) I might need to consider annotating some data myself}

The current training and validation set consists of data from 2015, collected and validated by Tu \cite{tu2016impact} \selfnote{make sure it was Tu}. The data is composed by:

\begin{itemize}
\item 6439 records of 481 commuters
\item 1628 records of 497 non-commuters
\end{itemize}

For a total of 978 IC card IDs. \selfnote{I got these from Tu, check the parameters are the same as the ones given by Liang or search for IDs in current data}

\subsubsection{Testing data}
Testing data is from 2016. More detailed

\subsection{Data preprocessing}
A  afirst step for preprocessing the data, we perform a cleaning where we eliminate records that are faulty, for example: 

\begin{enumerate}
\item Eliminate records with missing data: ~11\% records eliminated
\item Eliminate records with travel time <= 0: <1\% records eliminated
\item Eliminate records with travel distance <= 0: ~10.5\% records eliminated \Liangdoubt{how do we interpret these?}
\end{enumerate}



Whitening vs standardization

\subsection{Data mining techniques}
Coding using Python. Libraries and toolboxes such as pandas.

\subsubsection{Feature engineering}
The temporal factors to be explored are represented by the start/end times, as well travel/transfer time.

The spatial factors to be explored are represented by On/Off areas. \selfnote{and route lines?}. 

\subsubsection{Ensemble models}
Ensemble models are chosen because of its robustness and modularity. Starting from two simple classifiers, assembled via bagging, the model can grow larger or more complex as needed and it may be extended beyond the scope of this Thesis Project. 

\subsubsection{Decision trees and random forests}

\subsubsection{Neural networks}

\subsection{Correlation analysis}
chi-test


\newpage
\section{Commuters identification}
\subsection{Hypothesis}
As suggested by Tu \cite{tu2016impact} results, the data is almost linearly separable thus simple classifiers such as decision trees may suffice. 


\subsection{Model}
A first instance of the model will use all available variables in the data as used by Tu \cite{tu2016impact} for a fair model comparison. 

\subsection{Experiments}

\subsection{Results}

Accuracy

Confusion matrix


\newpage
\section{Variable evaluation}
\subsection{Hypothesis}
One of the main focuses of the second phase of this thesis is to determine the appropriate level of detail in the area to be taken into account. 

Middle area, big area and (small) area overlap. Middle and small divisions have more precision but maybe not needed. On the other hand, big area divisions might not capture the changes for people who live and work/study in the same bis district. 

\subsection{Qualitative}
Exploration: Experts opinion

\subsubsection{Interview}
\selfnote{In appendix?}
We interview Liang Quan as an Transportation domain expert. 

\begin{itemize}
\item To what extent do people live and work on the same area?
\item what level of detail do you think is appropriate?
\end{itemize}

\subsection{Quantitative}
Analysis: Correlation


\newpage
\section{Commuters clustering}
\subsection{Model}

\subsection{Experiments}

\subsection{Results}

\subsection{Expert judgment}


\newpage
\section{Conclusion}


\newpage
\section{Future work}

\newpage
\bibliography{mybib}{}
\bibliographystyle{plain}

\end{document}
